<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Edit Profile - Pet Adoption</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="{{url_for('static',filename='styles/style.css')}}">
  <style>
.form-floating {
  position: relative;
}
.form-control {
  padding: 1.5rem 1rem 0.5rem 3rem;
  font-size: 1rem;
  background: #f8f9fa;
  height: 60px;
}

.form-control:focus {
  border-color: #667eea;
  background: white;
}
.flash-messages {
  margin-bottom: 2rem;
}

.alert {
  padding: 1rem 1.5rem;
}
  </style>
</head>

<body>
  <div class="container">
    <div class="edit-container">
      <!-- Header Section -->
      <div class="edit-header">
        <div class="profile-icon">
          <i class="bi bi-person-fill"></i>
        </div>
        <h1 class="edit-title">Edit Your Profile</h1>
        <p class="edit-subtitle">Keep your information up to date</p>
      </div>

      <!-- Body Section -->
      <div class="edit-body">
        {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
          <div class="flash-messages">
            {% for category, message in messages %}
              <div class="alert alert-{{ 'success' if category == 'success' else 'danger' if category == 'error' else 'warning' }} alert-dismissible fade show">
                <i class="bi bi-{{ 'check-circle-fill' if category == 'success' else 'exclamation-triangle-fill' }} me-2"></i>
                {{ message }}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
              </div>
            {% endfor %}
          </div>
        {% endif %}
        {% endwith %}

        <form method="POST" action="{{url_for('edit_profile')}}" id="editForm">
          
          <!-- Account Information Section -->
          <div class="form-section">
            <div class="section-title">
              <i class="bi bi-person-badge"></i>
              Account Information
            </div>
            
            <!-- Username -->
            <div class="form-floating position-relative">
              <i class="bi bi-person-fill input-icon"></i>
              <input type="text" 
                     class="form-control" 
                     id="name" 
                     name="name" 
                     maxlength="10" 
                     minlength="5" 
                     value="{{ user[0] }}" 
                     placeholder="Username"
                     required
                     oninput="updateCharCount('name', 10)">
              <label for="name">Username</label>
              <span class="character-count" id="name-count">{{ user[0]|length }}/10</span>
            </div>
            <div class="input-helper">
              <i class="bi bi-info-circle"></i>
              Username must be between 5-10 characters
            </div>
          </div>

          <!-- Contact Information Section -->
          <div class="form-section">
            <div class="section-title">
              <i class="bi bi-telephone-fill"></i>
              Contact Information
            </div>
            
            <!-- Phone -->
            <div class="form-floating">
              <i class="bi bi-phone-fill input-icon"></i>
              <input type="text" 
                     class="form-control" 
                     id="phone" 
                     name="phone" 
                     minlength="10" 
                     maxlength="10" 
                     value="{{ user[2] }}" 
                     placeholder="Phone Number"
                     pattern="[0-9]{10}"
                     required>
              <label for="phone">Phone Number</label>
            </div>
            <div class="input-helper">
              <i class="bi bi-info-circle"></i>
              10-digit mobile number
            </div>
          </div>

          <!-- Location Information Section -->
          <div class="form-section">
            <div class="section-title">
              <i class="bi bi-geo-alt-fill"></i>
              Location Information
            </div>
            
            <!-- Address -->
            <div class="form-floating position-relative">
              <i class="bi bi-house-fill input-icon"></i>
              <input type="text" 
                     class="form-control" 
                     id="address" 
                     minlength="10" 
                     maxlength="50" 
                     name="address" 
                     value="{{ user[3] }}" 
                     placeholder="Address"
                     required
                     oninput="updateCharCount('address', 50)">
              <label for="address">Full Address</label>
              <span class="character-count" id="address-count">{{ user[3]|length }}/50</span>
            </div>
            
            <!-- City -->
            <div class="form-floating position-relative mt-3">
              <i class="bi bi-building input-icon"></i>
              <input type="text" 
                     class="form-control" 
                     id="city" 
                     minlength="3" 
                     maxlength="15" 
                     name="city" 
                     value="{{ user[4] }}" 
                     placeholder="City"
                     required
                     oninput="updateCharCount('city', 15)">
              <label for="city">City</label>
              <span class="character-count" id="city-count">{{ user[4]|length }}/15</span>
            </div>
            <div class="input-helper">
              <i class="bi bi-info-circle"></i>
              Helps connect you with nearby adopters
            </div>
          </div>

          <!-- Action Buttons -->
          <button type="submit" class="btn-save">
            <i class="bi bi-check-circle-fill me-2"></i>Save Changes
          </button>
          
          <a href="{{ url_for('profile') }}" class="btn-back">
            <i class="bi bi-arrow-left-circle-fill"></i>
            Back to Profile
          </a>
        </form>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    // Character counter function
    function updateCharCount(fieldId, maxLength) {
      const field = document.getElementById(fieldId);
      const counter = document.getElementById(fieldId + '-count');
      if (field && counter) {
        counter.textContent = field.value.length + '/' + maxLength;
        
        // Change color based on remaining characters
        const remaining = maxLength - field.value.length;
        if (remaining < 5) {
          counter.style.color = '#dc3545';
        } else if (remaining < 10) {
          counter.style.color = '#ffc107';
        } else {
          counter.style.color = '#adb5bd';
        }
      }
    }

    // Phone number validation - only numbers
    document.getElementById('phone').addEventListener('input', function(e) {
      this.value = this.value.replace(/[^0-9]/g, '');
    });

    // Form validation feedback
    const form = document.getElementById('editForm');
    form.addEventListener('submit', function(e) {
      const phone = document.getElementById('phone').value;
      
      if (phone.length !== 10) {
        e.preventDefault();
        alert('Phone number must be exactly 10 digits!');
        return false;
      }
    });

    // Initialize character counts on page load
    window.addEventListener('load', function() {
      updateCharCount('name', 10);
      updateCharCount('address', 50);
      updateCharCount('city', 15);
    });
  </script>
</body>
</html>